version: 1.0.{build}
image: Ubuntu

branches:
  only:
    - Sera

install:
  - sudo apt install -y nodejs npm curl
  - npm install -g webtorrent-cli
  - mkdir -p downloads

build_script:
  - |
      echo "Starting torrent download..."
      npx webtorrent download "magnet:?xt=urn:btih:C1552698DBF728A9F8DE4AC6A0C4C549CB697F7A&dn=Grimsburg%20S02E08%20Blue%20Light%20District%201080p%20HULU%20WEB-DL%20DD%205%201%20H%20264-playWEB&tr=udp%3A//tracker.coppersurfer.tk%3A6969/announce%26tr%3Dudp%3A//tracker.openbittorrent.com%3A6969/announce%26tr%3Dudp%3A//9.rarbg.to%3A2710/announce%26tr%3Dudp%3A//9.rarbg.me%3A2780/announce%26tr%3Dudp%3A//9.rarbg.to%3A2730/announce%26tr%3Dudp%3A//tracker.opentrackr.org%3A1337%26tr%3Dhttp%3A//p4p.arenabg.com%3A1337/announce%26tr%3Dudp%3A//tracker.torrent.eu.org%3A451/announce%26tr%3Dudp%3A//tracker.tiny-vps.com%3A6969/announce%26tr%3Dudp%3A//open.stealth.si%3A80/announce" "magnet:?xt=urn:btih:60b304ccec7c4b056349d492951a1d8b3de2bc77&dn=Grimsburg%20S02E09%20The%20Undies%201080p%20HULU%20WEB-DL%20DD%205%201%20H%20264-playWEB&tr=udp://tracker.bittor.pw:1337/announce&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://tracker.dler.org:6969/announce&tr=udp://open.stealth.si:80/announce&tr=udp://tracker.torrent.eu.org:451/announce&tr=udp://exodus.desync.com:6969/announce&tr=udp://open.demonii.com:1337/announce" "magnet:?xt=urn:btih:bf8963205d8f6b1f3b3f5319e53f2e9a878863ce&dn=Grimsburg%20S02E10%20Loosey%20Goosey%201080p%20HULU%20WEB-DL%20DD%205%201%20H%20264-playWEB&tr=udp://tracker.bittor.pw:1337/announce&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://tracker.dler.org:6969/announce&tr=udp://open.stealth.si:80/announce&tr=udp://tracker.torrent.eu.org:451/announce&tr=udp://exodus.desync.com:6969/announce&tr=udp://open.demonii.com:1337/announce" "magnet:?xt=urn:btih:00de05e5c7c4656a3337719a0c8bd8f785d978b9&dn=Grimsburg%20S02E11%20Evidence%20Locker%201080p%20HULU%20WEB-DL%20DD%205%201%20H%20264-playWEB&tr=udp://tracker.bittor.pw:1337/announce&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://tracker.dler.org:6969/announce&tr=udp://open.stealth.si:80/announce&tr=udp://tracker.torrent.eu.org:451/announce&tr=udp://exodus.desync.com:6969/announce&tr=udp://open.demonii.com:1337/announce" --out downloads --quiet

      echo "Uploading files to Pixeldrain..."

      find downloads -type f | while read file; do
        echo "Uploading $file..."
        curl -T "$file" -u :8ec6f000-e8d1-403d-820b-4324a6a68869 https://pixeldrain.com/api/file/
      done
